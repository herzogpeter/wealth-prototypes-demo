<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>FactSet Mercury API – Prototype Reference</title>
  <!-- SLDS 2.25.6 -->
  <link rel="stylesheet" href="slds-assets/styles/salesforce-lightning-design-system.min.css" />
  <style>
    body{padding:1rem;background:#f3f2f2;}
    .mercury-badge{background:#0070d2;color:#fff;padding:.15rem .45rem;border-radius:.25rem;font-size:.65rem;margin-right:.25rem;white-space:nowrap;}
    .audience-badge{font-size:.65rem;padding:.15rem .45rem;border-radius:.25rem;color:#fff;margin-left:.3rem;white-space:nowrap;}
    .advisor{background:#4bca81;}.client{background:#1589ee;}
    .filter-btn.active{background:#0070d2;color:#fff;}
    .code-btn{font-size:.6rem;padding:.1rem .4rem;margin-left:.3rem;}
    .tooltip-trigger-wrapper {
      position: relative;
      display: inline-block;
    }
    .slds-popover_tooltip .slds-popover__body { /* Ensure body text wraps */
      white-space: normal;
    }
  </style>
</head>
<body class="slds-scope">
  <!-- Breadcrumb -->
  <nav role="navigation" aria-label="Breadcrumbs" class="slds-m-bottom_medium">
    <ol class="slds-breadcrumb slds-list_horizontal slds-wrap">
      <li class="slds-breadcrumb__item">
        <a href="index.html">Home</a>
      </li>
      <li class="slds-breadcrumb__item">
        <span>Mercury Capability Map</span>
      </li>
    </ol>
  </nav>

  <!-- Page Header -->
  <div class="slds-page-header slds-page-header_record-home slds-m-bottom_large">
    <div class="slds-page-header__row">
      <div class="slds-page-header__col-title">
        <div class="slds-media">
          <div class="slds-media__figure">
            <span class="slds-icon_container slds-icon-standard-campaign" title="Mercury"><svg class="slds-icon slds-icon_small"><use xlink:href="slds-assets/icons/standard-sprite/svg/symbols.svg#campaign"></use></svg></span>
          </div>
          <div class="slds-media__body">
            <h1 class="slds-page-header__title">FactSet Mercury API – Prototype Capability Map</h1>
            <p class="slds-page-header__name-meta">Interactive reference for product & engineering</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Bar -->
  <div class="slds-card slds-m-bottom_large">
    <div class="slds-card__body slds-p-around_medium filter-bar">
      <span class="slds-text-title_bold slds-m-right_small">Filter by Mercury Capability:</span>
      
      <div class="tooltip-trigger-wrapper slds-m-right_x-small">
        <button class="slds-button slds-button_neutral filter-btn" data-filter="nlq" aria-describedby="tooltip-nlq">NL Q&A</button>
        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="tooltip-nlq" style="display:none; position:absolute; bottom:100%; left:50%; transform:translateX(-50%) translateY(-8px); width: 280px; z-index: 10;">
          <div class="slds-popover__body"></div>
        </div>
      </div>
      
      <div class="tooltip-trigger-wrapper slds-m-right_x-small">
        <button class="slds-button slds-button_neutral filter-btn" data-filter="attribution" aria-describedby="tooltip-attribution">Attribution</button>
        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="tooltip-attribution" style="display:none; position:absolute; bottom:100%; left:50%; transform:translateX(-50%) translateY(-8px); width: 280px; z-index: 10;">
          <div class="slds-popover__body"></div>
        </div>
      </div>
      
      <div class="tooltip-trigger-wrapper slds-m-right_x-small">
        <button class="slds-button slds-button_neutral filter-btn" data-filter="risk" aria-describedby="tooltip-risk">Risk</button>
        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="tooltip-risk" style="display:none; position:absolute; bottom:100%; left:50%; transform:translateX(-50%) translateY(-8px); width: 280px; z-index: 10;">
          <div class="slds-popover__body"></div>
        </div>
      </div>
      
      <div class="tooltip-trigger-wrapper slds-m-right_x-small">
        <button class="slds-button slds-button_neutral filter-btn" data-filter="events" aria-describedby="tooltip-events">Events</button>
        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="tooltip-events" style="display:none; position:absolute; bottom:100%; left:50%; transform:translateX(-50%) translateY(-8px); width: 280px; z-index: 10;">
          <div class="slds-popover__body"></div>
        </div>
      </div>
      
      <div class="tooltip-trigger-wrapper slds-m-right_x-small">
        <button class="slds-button slds-button_neutral filter-btn" data-filter="scenario" aria-describedby="tooltip-scenario">Scenario</button>
        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="tooltip-scenario" style="display:none; position:absolute; bottom:100%; left:50%; transform:translateX(-50%) translateY(-8px); width: 280px; z-index: 10;">
          <div class="slds-popover__body"></div>
        </div>
      </div>
      
      <div class="tooltip-trigger-wrapper slds-m-right_x-small">
        <button class="slds-button slds-button_neutral filter-btn" data-filter="content" aria-describedby="tooltip-content">Content Gen</button>
        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="tooltip-content" style="display:none; position:absolute; bottom:100%; left:50%; transform:translateX(-50%) translateY(-8px); width: 280px; z-index: 10;">
          <div class="slds-popover__body"></div>
        </div>
      </div>
      
      <div class="tooltip-trigger-wrapper slds-m-right_x-small">
        <button class="slds-button slds-button_neutral filter-btn" data-filter="realtime" aria-describedby="tooltip-realtime">Real‑Time</button>
        <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="tooltip-realtime" style="display:none; position:absolute; bottom:100%; left:50%; transform:translateX(-50%) translateY(-8px); width: 280px; z-index: 10;">
          <div class="slds-popover__body"></div>
        </div>
      </div>
      
      <button id="clear" class="slds-button slds-button_outline-brand slds-m-left_medium">Clear</button>
    </div>
  </div>

  <!-- Prototype List -->
  <div class="slds-grid slds-wrap" id="cards">
    <!-- Template injected via JS -->
  </div>

<script>
// === Data (truncated sample for brevity, insert full list in production) ===
const data=[
 {id:'ai_research',name:'AI Research & Decision Support',aud:'advisor',link:'index.html?prototype=ai_research_assistant',caps:['nlq','realtime'],desc:'Virtual research assistant answering NL queries.'},
 {id:'risk_dash',name:'Risk Monitoring Dashboard',aud:'advisor',link:'index.html?prototype=real_time_portfolio_risk_alerts',caps:['risk'],desc:'Mercury risk scores & alerts for portfolios.'},
 {id:'client_chat',name:'Client Portfolio Chatbot',aud:'client',link:'index.html?prototype=interactive_client_portal',caps:['nlq','realtime'],desc:'Client Q&A bot with live data.'},
 {id:'commentary',name:'AI Portfolio Commentary',aud:'advisor',link:'index.html?prototype=automated_personalized_reports',caps:['content','attribution','events'],desc:'Narrative report generator.'},
];
// === Render cards ===
const grid=document.getElementById('cards');
function render(){grid.innerHTML='';data.forEach(p=>{
 const card=document.createElement('article');card.className='slds-card slds-size_1-of-1 slds-medium-size_1-of-2 slds-p-around_medium slds-m-bottom_medium proto';card.dataset.caps=p.caps.join(' ');
 card.innerHTML=`<div class="slds-text-heading_small">${p.name} <span class="audience-badge ${p.aud}">${p.aud==='client'?'Client':'Advisor'}</span></div>
 <p class="slds-m-vertical_x-small">${p.desc}</p>
 <p><a class="slds-button slds-button_link" href="${p.link}" target="_blank">Open Prototype</a></p>
 <div class="slds-m-top_x-small">${p.caps.map(c=>`<span class="mercury-badge">${capLabel(c)}</span>`).join('')}</div>`;
 grid.appendChild(card);});}
function capLabel(k){return {nlq:'NL Q&A',attribution:'Attribution',risk:'Risk',events:'Events',scenario:'Scenario',content:'Content',realtime:'Real‑Time'}[k]||k;}
render();

// === Tooltip Descriptions & Logic ===
const tooltipDescriptions = {
  nlq: "Mercury’s conversational LLM that lets advisors or clients ask plain-English questions (e.g., “How did my portfolio do vs. the S&P 500?”) and instantly receive data-backed answers.",
  attribution: "Analytics that decompose a portfolio’s return into factors such as asset allocation, security selection, sector bets, and currency effects. Used for “why did I outperform/underperform?” explanations.",
  risk: "Real-time risk metrics (volatility, Value-at-Risk, beta, downgrade alerts, ESG score shifts) and rule-based alerts when exposure breaches thresholds.",
  events: "Continuous scanning of news, filings, and market data for events that may impact a client (e.g., liquidity events, earnings surprises, corporate actions) and surfacing them in Salesforce.",
  scenario: "Tools to simulate “what-if” market scenarios (rate shocks, recessions, sector crashes) and forecast how client portfolios or goals would be affected.",
  content: "Generative AI that drafts narrative commentary, market recaps, or personalized report sections using Mercury’s data plus language models—saving advisors writing time.",
  realtime: "Up-to-the-second quotes, price histories, and index data streams that power live dashboards, tickers, and instant performance calculations."
};

document.querySelectorAll('.tooltip-trigger-wrapper').forEach(trigger => {
  const button = trigger.querySelector('.filter-btn');
  if (!button) return; // Should not happen with current HTML structure
  
  const tooltip = trigger.querySelector('.slds-popover_tooltip');
  if (!tooltip) return; // Should not happen

  const filterKey = button.dataset.filter;
  const tooltipBody = tooltip.querySelector('.slds-popover__body');

  if (tooltipBody && tooltipDescriptions[filterKey]) {
    tooltipBody.textContent = tooltipDescriptions[filterKey];
  }

  const showTooltip = () => { tooltip.style.display = 'block'; };
  const hideTooltip = () => { tooltip.style.display = 'none'; };

  button.addEventListener('mouseenter', showTooltip);
  button.addEventListener('focus', showTooltip);
  button.addEventListener('mouseleave', hideTooltip);
  button.addEventListener('blur', hideTooltip);
  
  tooltip.addEventListener('mouseenter', showTooltip); // Keep tooltip visible if mouse enters it
  tooltip.addEventListener('mouseleave', hideTooltip); // Hide tooltip if mouse leaves it
});

// === Filter logic ===
const btns=[...document.querySelectorAll('.filter-btn')];
btns.forEach(b=>b.onclick=()=>{b.classList.toggle('active');filter();});
function filter(){const act=btns.filter(b=>b.classList.contains('active')).map(b=>b.dataset.filter);
 document.querySelectorAll('.proto').forEach(card=>{const caps=card.dataset.caps.split(' ');card.style.display=act.every(a=>caps.includes(a))?'':'none';});}
document.getElementById('clear').onclick=()=>{btns.forEach(b=>b.classList.remove('active'));filter();};
</script>
</body>
</html>
